# 一、实验目的
在实际场景中，为了减少从头开始训练所带来的时间成本，大多数情况下会基于已有的模型来进行迁移学习。
本次实验将会以狗和狼的图像分类为例，用 MindSpore 加载预训练模型，并通过固定权重来实现迁移学习。

# 二、实验环境
|操作系统|编程环境|程序运行环境|
|:----:|:-----:|:-----:|
|Ubuntu 18.04|Visual Studio Code|python3.9+mindspore1.5.2|

# 三、实验原理
在实际场景中，为了减少从头开始训练所带来的时间成本，大多数情况下会基于已有的模型来进行迁移学习。迁移学习可以使得预训练模型的先验知识得到更好的保留，提升下游任务的表达能力以及泛化能力。
<br>
# 四、实验步骤
## 1)数据、预训练模型准备
下载案例所用到的狗与狼分类数据集，数据集中的图像来自于 ImageNet，每个分类有大约 120 张训练图像与 30 张验证图像。将下载后的数据集解压到当前目录下。
下载预训练模型的 ckpt 文件，将其保存在当前目录。

## 2)数据处理
`bash MNISH.sh`

## 3)训练一个 LeNet 网络作为演示：
`python prepare.py`

训练过程截图：
<br>
![](fig/img_2.png)

## 4)实现 FGSM
`python FGSM.py`

下面演示受攻击照片现在的实际形态，可以看出图片并没有发生明显的改变，然而在精度测试中却有了不一样的结果：
<br>
![](fig/img_3.png)

# 报错
- `AttributeError: module 'numpy' has no attribute 'str'.`
则注释 \site-packages\mindspore\common\dtype.py中的np.str: string,



